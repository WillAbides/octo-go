package main

import (
	"bytes"
	"io/ioutil"
	"path/filepath"
	"runtime"
)

func reqHelperFile(reqPkg, rtPkgPath string) ([]byte, error) {
	result := []byte("// Code generated by octo-go; DO NOT EDIT.\n\n")
	_, thisFile, _, _ := runtime.Caller(0)
	thisDir := filepath.Dir(thisFile)
	tmplFile := filepath.Join(thisDir, "helpertmpl", "helpertmpl.go")
	tmpl, err := ioutil.ReadFile(tmplFile)
	if err != nil {
		return nil, err
	}
	tmpl = bytes.ReplaceAll(tmpl, []byte("helpertmpl"), []byte(reqPkg))
	tmpl = bytes.ReplaceAll(tmpl, []byte("github.com/willabides/octo-go"), []byte(rtPkgPath))
	result = append(result, tmpl...)
	return result, nil
}
